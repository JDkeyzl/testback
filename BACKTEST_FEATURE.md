# å›æµ‹åŠŸèƒ½ä½¿ç”¨æŒ‡å—

## ğŸ‰ æ–°åŠŸèƒ½ï¼šè¿è¡Œç­–ç•¥å›æµ‹

### åŠŸèƒ½æ¦‚è¿°

åœ¨å³ä¾§å›æµ‹ç»“æœåŒºåŸŸï¼Œæˆ‘ä»¬æ–°å¢äº†"è¿è¡Œç­–ç•¥"æŒ‰é’®ï¼Œå¯ä»¥è°ƒç”¨åç«¯APIè¿›è¡Œç­–ç•¥å›æµ‹ï¼Œå¹¶ç”¨Rechartså±•ç¤ºç»“æœã€‚

### ä¸»è¦ç‰¹æ€§

#### 1. è¿è¡Œç­–ç•¥æŒ‰é’®
- **ä½ç½®**: å³ä¾§å›æµ‹ç»“æœé¢æ¿é¡¶éƒ¨
- **åŠŸèƒ½**: ç‚¹å‡»åè°ƒç”¨åç«¯ `/backtest` æ¥å£
- **çŠ¶æ€**: æ˜¾ç¤ºåŠ è½½åŠ¨ç”»å’Œè¿è¡ŒçŠ¶æ€
- **é”™è¯¯å¤„ç†**: å¦‚æœAPIè°ƒç”¨å¤±è´¥ï¼Œè‡ªåŠ¨ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®

#### 2. å›æµ‹ç»“æœå±•ç¤º

##### æ¦‚è§ˆæ ‡ç­¾é¡µ
- **å…³é”®æŒ‡æ ‡å¡ç‰‡**:
  - æ€»æ”¶ç›Šç‡ (ç»¿è‰²)
  - å¹´åŒ–æ”¶ç›Šç‡ (è“è‰²)  
  - æœ€å¤§å›æ’¤ (çº¢è‰²)
  - å¤æ™®æ¯”ç‡ (ç´«è‰²)

- **è¯¦ç»†æŒ‡æ ‡è¡¨æ ¼**:
  - èƒœç‡ã€ç›ˆäºæ¯”ã€æ€»äº¤æ˜“æ¬¡æ•°
  - ç›ˆåˆ©äº¤æ˜“æ•°ã€äºæŸäº¤æ˜“æ•°ã€æœ€ç»ˆèµ„é‡‘

- **èµ„é‡‘æ›²çº¿å›¾è¡¨**:
  - ä½¿ç”¨Recharts LineChartå±•ç¤º
  - æ˜¾ç¤ºç­–ç•¥å‡€å€¼å˜åŒ–è¶‹åŠ¿
  - æ”¯æŒé¼ æ ‡æ‚¬åœæŸ¥çœ‹è¯¦ç»†æ•°æ®

##### å›¾è¡¨æ ‡ç­¾é¡µ
- **æ”¶ç›Šç‡åˆ†å¸ƒå›¾**:
  - ä½¿ç”¨Recharts BarChartå±•ç¤º
  - æ˜¾ç¤ºå„æ—¶é—´æ®µçš„æ”¶ç›Šç‡
  - ç›´è§‚å±•ç¤ºç­–ç•¥è¡¨ç°

##### äº¤æ˜“è®°å½•æ ‡ç­¾é¡µ
- **äº¤æ˜“å†å²è¡¨æ ¼**:
  - æ—¶é—´ã€ç±»å‹ã€ä»·æ ¼ã€æ•°é‡ã€é‡‘é¢ã€ç›ˆäº
  - ä¹°å…¥æ˜¾ç¤ºç»¿è‰²ï¼Œå–å‡ºæ˜¾ç¤ºçº¢è‰²
  - ç›ˆäºç”¨é¢œè‰²åŒºåˆ†æ­£è´Ÿ

### æŠ€æœ¯å®ç°

#### å‰ç«¯åŠŸèƒ½
```javascript
// ä¸»è¦åŠŸèƒ½å‡½æ•°
const runBacktest = async () => {
  // 1. æ„å»ºç­–ç•¥æ•°æ®
  const strategyData = buildStrategyData()
  
  // 2. è°ƒç”¨åç«¯API
  const response = await fetch('http://localhost:8000/api/v1/backtest', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ strategy: strategyData })
  })
  
  // 3. å¤„ç†ç»“æœå¹¶æ›´æ–°UI
  const result = await response.json()
  setBacktestResult(result)
}
```

#### æ•°æ®æµç¨‹
1. **ç­–ç•¥æ„å»º**: ä»Zustandå…¨å±€çŠ¶æ€è·å–èŠ‚ç‚¹å‚æ•°
2. **APIè°ƒç”¨**: å‘é€POSTè¯·æ±‚åˆ°åç«¯å›æµ‹æ¥å£
3. **ç»“æœå¤„ç†**: è§£æå›æµ‹ç»“æœå¹¶æ ¼å¼åŒ–æ•°æ®
4. **UIæ›´æ–°**: æ›´æ–°å›¾è¡¨å’Œè¡¨æ ¼æ˜¾ç¤º

#### é”™è¯¯å¤„ç†
- **APIå¤±è´¥**: è‡ªåŠ¨é™çº§åˆ°æ¨¡æ‹Ÿæ•°æ®
- **ç½‘ç»œé”™è¯¯**: æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯æç¤º
- **æ•°æ®éªŒè¯**: æ£€æŸ¥ç­–ç•¥èŠ‚ç‚¹æ˜¯å¦ä¸ºç©º

### ä½¿ç”¨æ–¹æ³•

#### 1. æ„å»ºç­–ç•¥
1. åœ¨å·¦ä¾§ç”»å¸ƒæ·»åŠ ç­–ç•¥èŠ‚ç‚¹
2. é…ç½®èŠ‚ç‚¹å‚æ•°ï¼ˆåœ¨å³ä¾§å‚æ•°é¢æ¿ï¼‰
3. è¿æ¥èŠ‚ç‚¹å½¢æˆç­–ç•¥é€»è¾‘

#### 2. è¿è¡Œå›æµ‹
1. ç‚¹å‡»å³ä¾§"è¿è¡Œç­–ç•¥"æŒ‰é’®
2. ç­‰å¾…å›æµ‹å®Œæˆï¼ˆæ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼‰
3. æŸ¥çœ‹å›æµ‹ç»“æœ

#### 3. åˆ†æç»“æœ
1. **æ¦‚è§ˆ**: æŸ¥çœ‹å…³é”®æŒ‡æ ‡å’Œèµ„é‡‘æ›²çº¿
2. **å›¾è¡¨**: åˆ†ææ”¶ç›Šç‡åˆ†å¸ƒ
3. **äº¤æ˜“è®°å½•**: æŸ¥çœ‹è¯¦ç»†äº¤æ˜“å†å²

### æ•°æ®æ ¼å¼

#### ç­–ç•¥æ•°æ®æ ¼å¼
```json
{
  "strategy": {
    "nodes": [
      {
        "id": "condition1",
        "type": "condition",
        "data": {
          "type": "ma",
          "period": 20,
          "threshold": 50.0,
          "operator": ">"
        }
      }
    ],
    "edges": [
      {
        "id": "e1-2",
        "source": "condition1",
        "target": "action1"
      }
    ],
    "start_date": "2023-01-01",
    "end_date": "2023-12-31",
    "initial_capital": 100000.0,
    "commission_rate": 0.001
  }
}
```

#### å›æµ‹ç»“æœæ ¼å¼
```json
{
  "metrics": {
    "total_return": 0.15,
    "annual_return": 0.12,
    "max_drawdown": 0.08,
    "sharpe_ratio": 1.2,
    "win_rate": 0.65,
    "profit_loss_ratio": 1.8,
    "total_trades": 50,
    "winning_trades": 32,
    "losing_trades": 18
  },
  "equity_curve": [
    {
      "date": "2023-01-01",
      "equity": 100000.0,
      "returns": 0.0
    }
  ],
  "trades": [
    {
      "date": "2023-01-15",
      "action": "buy",
      "price": 100.0,
      "quantity": 100,
      "amount": 10000.0,
      "pnl": 0.0
    }
  ],
  "final_equity": 115000.0
}
```

### å›¾è¡¨é…ç½®

#### èµ„é‡‘æ›²çº¿ (LineChart)
- **æ•°æ®æº**: `equity_curve`
- **Xè½´**: æ—¥æœŸ
- **Yè½´**: èµ„é‡‘å‡€å€¼
- **é¢œè‰²**: è“è‰² (#2563eb)
- **å·¥å…·æç¤º**: æ˜¾ç¤ºæ—¥æœŸå’Œå‡€å€¼

#### æ”¶ç›Šç‡åˆ†å¸ƒ (BarChart)
- **æ•°æ®æº**: `equity_curve` (returnså­—æ®µ)
- **Xè½´**: æ—¥æœŸ
- **Yè½´**: æ”¶ç›Šç‡ç™¾åˆ†æ¯”
- **é¢œè‰²**: ç»¿è‰² (#10b981)
- **å·¥å…·æç¤º**: æ˜¾ç¤ºæ—¥æœŸå’Œæ”¶ç›Šç‡

### çŠ¶æ€ç®¡ç†

#### ç»„ä»¶çŠ¶æ€
```javascript
const [isRunning, setIsRunning] = useState(false)      // è¿è¡ŒçŠ¶æ€
const [backtestResult, setBacktestResult] = useState(null)  // å›æµ‹ç»“æœ
const [error, setError] = useState(null)               // é”™è¯¯ä¿¡æ¯
const [activeTab, setActiveTab] = useState('overview') // å½“å‰æ ‡ç­¾é¡µ
```

#### å…¨å±€çŠ¶æ€
- ä½¿ç”¨Zustandç®¡ç†èŠ‚ç‚¹å‚æ•°
- å®æ—¶åŒæ­¥å‚æ•°å˜åŒ–
- æ”¯æŒå¤šèŠ‚ç‚¹é…ç½®

### æ€§èƒ½ä¼˜åŒ–

#### æ•°æ®å¤„ç†
- æ‡’åŠ è½½å›¾è¡¨æ•°æ®
- é˜²æŠ–å¤„ç†ç”¨æˆ·æ“ä½œ
- å†…å­˜ä¼˜åŒ–å¤§é‡æ•°æ®

#### ç”¨æˆ·ä½“éªŒ
- åŠ è½½çŠ¶æ€æŒ‡ç¤º
- é”™è¯¯æç¤ºå‹å¥½
- å“åº”å¼è®¾è®¡

### æ‰©å±•åŠŸèƒ½

#### å¯æ·»åŠ çš„åŠŸèƒ½
1. **ç­–ç•¥æ¯”è¾ƒ**: åŒæ—¶è¿è¡Œå¤šä¸ªç­–ç•¥å¯¹æ¯”
2. **å‚æ•°ä¼˜åŒ–**: è‡ªåŠ¨å¯»æ‰¾æœ€ä¼˜å‚æ•°ç»„åˆ
3. **é£é™©åˆ†æ**: æ›´è¯¦ç»†çš„é£é™©æŒ‡æ ‡
4. **å¯¼å‡ºåŠŸèƒ½**: å¯¼å‡ºå›æµ‹ç»“æœå’Œå›¾è¡¨
5. **å†å²è®°å½•**: ä¿å­˜å’ŒåŠ è½½å†å²å›æµ‹

#### æŠ€æœ¯æ”¹è¿›
1. **å®æ—¶æ•°æ®**: æ¥å…¥çœŸå®è‚¡ç¥¨æ•°æ®
2. **æ›´å¤šæŒ‡æ ‡**: æ·»åŠ æ›´å¤šæŠ€æœ¯åˆ†ææŒ‡æ ‡
3. **æ€§èƒ½ä¼˜åŒ–**: å¤§æ•°æ®é‡å¤„ç†ä¼˜åŒ–
4. **ç¼“å­˜æœºåˆ¶**: ç¼“å­˜å›æµ‹ç»“æœ

## æ€»ç»“

æ–°çš„å›æµ‹åŠŸèƒ½æä¾›äº†å®Œæ•´çš„ç­–ç•¥æµ‹è¯•å’Œåˆ†æèƒ½åŠ›ï¼š

âœ… **å®Œæ•´çš„å›æµ‹æµç¨‹**: ä»ç­–ç•¥æ„å»ºåˆ°ç»“æœåˆ†æ
âœ… **ä¸°å¯Œçš„å¯è§†åŒ–**: å¤šç§å›¾è¡¨å±•ç¤ºå›æµ‹æ•°æ®  
âœ… **å‹å¥½çš„ç”¨æˆ·ä½“éªŒ**: åŠ è½½çŠ¶æ€ã€é”™è¯¯å¤„ç†ã€å“åº”å¼è®¾è®¡
âœ… **çµæ´»çš„æ•°æ®å¤„ç†**: æ”¯æŒçœŸå®APIå’Œæ¨¡æ‹Ÿæ•°æ®
âœ… **è¯¦ç»†çš„æŒ‡æ ‡åˆ†æ**: å…¨é¢çš„ç­–ç•¥è¡¨ç°è¯„ä¼°

è¿™ä¸ªåŠŸèƒ½ä¸ºTestBackå¹³å°æä¾›äº†æ ¸å¿ƒçš„ç­–ç•¥éªŒè¯èƒ½åŠ›ï¼Œç”¨æˆ·å¯ä»¥ï¼š
- æ„å»ºå¤æ‚çš„äº¤æ˜“ç­–ç•¥
- å®æ—¶æµ‹è¯•ç­–ç•¥æ•ˆæœ
- åˆ†æç­–ç•¥è¡¨ç°
- ä¼˜åŒ–ç­–ç•¥å‚æ•°

ä¸ºè¿›ä¸€æ­¥çš„ç­–ç•¥å¼€å‘å’Œä¼˜åŒ–å¥ å®šäº†åšå®çš„åŸºç¡€ã€‚
